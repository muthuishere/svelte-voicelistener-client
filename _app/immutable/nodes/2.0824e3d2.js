import{s as A,n as x,r as N}from"../chunks/scheduler.b0c1c2c3.js";import{S as C,i as O,g as h,s as T,h as _,j as S,f as m,c as R,k as g,a as v,A as y,B as E,C as P,m as $,n as I,r as q,D as B,y as H,u as L,v as M,d as W,t as D,w as F}from"../chunks/index.6ef83612.js";const K=!0,de=Object.freeze(Object.defineProperty({__proto__:null,prerender:K},Symbol.toStringTag,{value:"Module"}));async function U(r,e){const t=r.body.getReader();try{for(;;){const{done:n,value:o}=await t.read();if(!n)z(o).filter(V).map(X).forEach(c=>e({value:c,done:!1}));else{e({value:{},done:!0});break}}}finally{t.releaseLock()}}function z(r){let e="";return r instanceof Uint8Array?e=new TextDecoder("utf-8").decode(r):e=r,e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0).map(t=>t.replace("data: ",""))}function V(r){try{JSON.parse(r)}catch{return!1}return!0}function X(r){let e={};try{e=JSON.parse(r);const t=e.choices.map(n=>n.delta).filter(n=>n.hasOwnProperty("content")).map(n=>n.content).reduce((n,o)=>n+o,"");return{...e,content:t}}catch(t){return console.log(t),e}}async function Y(r){let e="";const t=r.body.getReader();try{for(;;){const{done:n,value:o}=await t.read();if(!n)e+=z(o).reduce((c,l)=>c+l,"");else break}}finally{t.releaseLock()}return e}async function Q(r){const e=await Y(r),{status:t}=r;let n=JSON.parse(e);n=n||{error:{}};const o={status:t,...n};let{code:c,message:l}=o.error;return c=c||"",l=l||"",`ChatGPT API Error :  ${c}  ${l}   HTTP Status Code: ${t}.<br/> Try Changing the key or contact support.`}async function Z(r,e,t){const{apiKey:n,chatGptRole:o}=e,c="https://api.openai.com/v1/chat/completions",p={messages:[{role:"system",content:o},{role:"user",content:r}],temperature:.7,max_tokens:500,top_p:1,frequency_penalty:0,presence_penalty:0,model:"gpt-4",stream:!0},a={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(p)};try{const s=await fetch(c,a);if(!s.ok){const i=await Q(s);t({content:"",done:!0,error:i});return}await U(s,i=>{const{done:d,value:f}=i;d?t({content:"",done:!0,error:null}):f.content&&t({content:f.content,done:!1,error:null})})}catch(s){console.error("Error fetching ChatGPT API:",s),t({content:"",done:!0,error:s})}}function ee(r){return new Promise((e,t)=>{try{const n=new WebSocket(r);n.onopen=()=>e(te(n)),n.onerror=o=>t(o)}catch(n){t(n)}})}function te(r){return{sendPartial:function(e){console.log("sending partial to server"+e),r.send(e)},sendFinal:function(e){console.log("sending final to server"+e),r.send(e)},sendError:function(e){console.log("sending error to server"+e),r.send(e)},getSocket:function(){return r}}}function ne(r){let e;return{c(){e=$("Start")},l(t){e=I(t,"Start")},m(t,n){v(t,e,n)},d(t){t&&m(e)}}}function re(r){let e;return{c(){e=$("Stop")},l(t){e=I(t,"Stop")},m(t,n){v(t,e,n)},d(t){t&&m(e)}}}function oe(r){let e,t,n,o,c,l;function u(s,i){return s[1]?re:ne}let p=u(r),a=p(r);return{c(){e=h("div"),t=h("textarea"),n=T(),o=h("button"),a.c(),this.h()},l(s){e=_(s,"DIV",{class:!0});var i=S(e);t=_(i,"TEXTAREA",{class:!0,rows:!0,cols:!0}),S(t).forEach(m),n=R(i),o=_(i,"BUTTON",{class:!0});var d=S(o);a.l(d),d.forEach(m),i.forEach(m),this.h()},h(){g(t,"class","form-input svelte-u6id73"),g(t,"rows","10"),g(t,"cols","50"),g(o,"class","form-button svelte-u6id73"),g(e,"class","form-container svelte-u6id73")},m(s,i){v(s,e,i),y(e,t),E(t,r[0]),y(e,n),y(e,o),a.m(o,null),c||(l=[P(t,"input",r[3]),P(o,"click",r[2])],c=!0)},p(s,[i]){i&1&&E(t,s[0]),p!==(p=u(s))&&(a.d(1),a=p(s),a&&(a.c(),a.m(o,null)))},i:x,o:x,d(s){s&&m(e),a.d(),c=!1,N(l)}}}function se(r,e,t){let n="",o=!1,c=!1,l=null,u=null;const p=window.SpeechRecognition||window.webkitSpeechRecognition;p?(l=new p,l.continuous=!0,l.interimResults=!0,l.onstart=function(){t(1,o=!0)},l.onerror=function(d){console.error(d.error)},l.onend=function(){console.log("recognizing ended"),t(1,o=!1),c||l.start()},l.onresult=function(d){for(let f=d.resultIndex;f<d.results.length;++f)if(d.results[f].isFinal){let w=d.results[f][0].transcript;setTimeout(()=>{a(w)},1e3),t(0,n+=w)}}):alert("Your Browser does not support the Speech Recognition API. Please try with Google Chrome.");async function a(d){if(u==null){let b=localStorage.getItem("url");u=await ee(b)}let f="",w=localStorage.getItem("chatGptRole"),j=localStorage.getItem("apiKey");await Z(d,{apiKey:j,chatGptRole:w},b=>{const{content:G,done:J,error:k}=b;k?u.sendError(k):(f+=G,J?u.sendFinal(f):u.sendPartial(f))})}const s=()=>{if(o){c=!0,l.stop();return}else c=!1,l.start()};function i(){n=this.value,t(0,n)}return[n,o,s,i]}class ae extends C{constructor(e){super(),O(this,e,se,oe,A,{})}}const le="/svelte-voicelistener-client/_app/immutable/assets/svelte-welcome.c18bcf5a.webp",ce="/svelte-voicelistener-client/_app/immutable/assets/svelte-welcome.6c300099.png";function ie(r){let e,t,n,o,c=`<span class="welcome svelte-19xx0bt"><picture><source srcset="${le}" type="image/webp"/> <img src="${ce}" alt="Welcome" class="svelte-19xx0bt"/></picture></span>

		to your Speech Recognizer<br/> app`,l,u,p;return u=new ae({}),{c(){e=h("meta"),t=T(),n=h("section"),o=h("h1"),o.innerHTML=c,l=T(),q(u.$$.fragment),this.h()},l(a){const s=B("svelte-t32ptj",document.head);e=_(s,"META",{name:!0,content:!0}),s.forEach(m),t=R(a),n=_(a,"SECTION",{class:!0});var i=S(n);o=_(i,"H1",{class:!0,"data-svelte-h":!0}),H(o)!=="svelte-1xqjfd8"&&(o.innerHTML=c),l=R(i),L(u.$$.fragment,i),i.forEach(m),this.h()},h(){document.title="Home",g(e,"name","description"),g(e,"content","Svelte demo app"),g(o,"class","svelte-19xx0bt"),g(n,"class","svelte-19xx0bt")},m(a,s){y(document.head,e),v(a,t,s),v(a,n,s),y(n,o),y(n,l),M(u,n,null),p=!0},p:x,i(a){p||(W(u.$$.fragment,a),p=!0)},o(a){D(u.$$.fragment,a),p=!1},d(a){a&&(m(t),m(n)),m(e),F(u)}}}class fe extends C{constructor(e){super(),O(this,e,null,ie,A,{})}}export{fe as component,de as universal};
